import{Ar as e,Bi as t,Bt as n,On as r,V as i,Zr as a,ci as o,kn as s,rt as c,xi as l}from"./index-BPCKOvYy.js";import{l as u,m as d,p as f,r as p,s as m}from"./BufferGeometry-Bn0KB3W4-YHVejfVJ.js";var h=new s,g=new s,_=new s,v=new s,y=new s,b=new s,x=new s,S=new s,C=new s,w=new s,T=new t,E=new t,D=new t,O=class e{constructor(e=new s,t=new s,n=new s){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),h.subVectors(e,t),r.cross(h);let i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){h.subVectors(r,t),g.subVectors(n,t),_.subVectors(e,t);let a=h.dot(h),o=h.dot(g),s=h.dot(_),c=g.dot(g),l=g.dot(_),u=a*c-o*o;if(u===0)return i.set(0,0,0),null;let d=1/u,f=(c*s-o*l)*d,p=(a*l-o*s)*d;return i.set(1-f-p,p,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,v)===null?!1:v.x>=0&&v.y>=0&&v.x+v.y<=1}static getInterpolation(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,v)===null?(s.x=0,s.y=0,`z`in s&&(s.z=0),`w`in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(i,v.x),s.addScaledVector(a,v.y),s.addScaledVector(o,v.z),s)}static getInterpolatedAttribute(e,t,n,r,i,a){return T.setScalar(0),E.setScalar(0),D.setScalar(0),T.fromBufferAttribute(e,t),E.fromBufferAttribute(e,n),D.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(T,i.x),a.addScaledVector(E,i.y),a.addScaledVector(D,i.z),a}static isFrontFacing(e,t,n,r){return h.subVectors(n,t),g.subVectors(e,t),h.cross(g).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return h.subVectors(this.c,this.b),g.subVectors(this.a,this.b),h.cross(g).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return e.getNormal(this.a,this.b,this.c,t)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}getInterpolation(t,n,r,i,a){return e.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}containsPoint(t){return e.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return e.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,r=this.b,i=this.c,a,o;y.subVectors(r,n),b.subVectors(i,n),S.subVectors(e,n);let s=y.dot(S),c=b.dot(S);if(s<=0&&c<=0)return t.copy(n);C.subVectors(e,r);let l=y.dot(C),u=b.dot(C);if(l>=0&&u<=l)return t.copy(r);let d=s*u-l*c;if(d<=0&&s>=0&&l<=0)return a=s/(s-l),t.copy(n).addScaledVector(y,a);w.subVectors(e,i);let f=y.dot(w),p=b.dot(w);if(p>=0&&f<=p)return t.copy(i);let m=f*c-s*p;if(m<=0&&c>=0&&p<=0)return o=c/(c-p),t.copy(n).addScaledVector(b,o);let h=l*p-f*u;if(h<=0&&u-l>=0&&f-p>=0)return x.subVectors(i,r),o=(u-l)/(u-l+(f-p)),t.copy(r).addScaledVector(x,o);let g=1/(h+m+d);return a=m*g,o=d*g,t.copy(n).addScaledVector(y,a).addScaledVector(b,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},k=class extends u{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type=`MeshBasicMaterial`,this.color=new f(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new i,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap=`round`,this.wireframeLinejoin=`round`,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},A=new l,j=new d,M=new n,N=new s,P=new s,F=new s,I=new s,L=new s,R=new s,z=new s,B=new s,V=class extends a{constructor(e=new p,t=new k){super(),this.isMesh=!0,this.type=`Mesh`,this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let n=e[t[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){let t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){let n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);let o=this.morphTargetInfluences;if(i&&o){R.set(0,0,0);for(let n=0,r=i.length;n<r;n++){let r=o[n],s=i[n];r!==0&&(L.fromBufferAttribute(s,e),a?R.addScaledVector(L,r):R.addScaledVector(L.sub(t),r))}t.add(R)}return t}raycast(e,t){let n=this.geometry,r=this.material,i=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),M.copy(n.boundingSphere),M.applyMatrix4(i),j.copy(e.ray).recast(e.near),!(M.containsPoint(j.origin)===!1&&(j.intersectSphere(M,N)===null||j.origin.distanceToSquared(N)>(e.far-e.near)**2))&&(A.copy(i).invert(),j.copy(e.ray).applyMatrix4(A),!(n.boundingBox!==null&&j.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,j)))}_computeIntersections(e,t,n){let r,i=this.geometry,a=this.material,o=i.index,s=i.attributes.position,c=i.attributes.uv,l=i.attributes.uv1,u=i.attributes.normal,d=i.groups,f=i.drawRange;if(o!==null)if(Array.isArray(a))for(let i=0,s=d.length;i<s;i++){let s=d[i],p=a[s.materialIndex],m=Math.max(s.start,f.start),h=Math.min(o.count,Math.min(s.start+s.count,f.start+f.count));for(let i=m,a=h;i<a;i+=3){let a=o.getX(i),d=o.getX(i+1),f=o.getX(i+2);r=U(this,p,e,n,c,l,u,a,d,f),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=s.materialIndex,t.push(r))}}else{let i=Math.max(0,f.start),s=Math.min(o.count,f.start+f.count);for(let d=i,f=s;d<f;d+=3){let i=o.getX(d),s=o.getX(d+1),f=o.getX(d+2);r=U(this,a,e,n,c,l,u,i,s,f),r&&(r.faceIndex=Math.floor(d/3),t.push(r))}}else if(s!==void 0)if(Array.isArray(a))for(let i=0,o=d.length;i<o;i++){let o=d[i],p=a[o.materialIndex],m=Math.max(o.start,f.start),h=Math.min(s.count,Math.min(o.start+o.count,f.start+f.count));for(let i=m,a=h;i<a;i+=3){let a=i,s=i+1,d=i+2;r=U(this,p,e,n,c,l,u,a,s,d),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=o.materialIndex,t.push(r))}}else{let i=Math.max(0,f.start),o=Math.min(s.count,f.start+f.count);for(let s=i,d=o;s<d;s+=3){let i=s,o=s+1,d=s+2;r=U(this,a,e,n,c,l,u,i,o,d),r&&(r.faceIndex=Math.floor(s/3),t.push(r))}}}};function H(e,t,n,r,i,a,o,s){let c;if(c=t.side===1?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side===0,s),c===null)return null;B.copy(s),B.applyMatrix4(e.matrixWorld);let l=n.ray.origin.distanceTo(B);return l<n.near||l>n.far?null:{distance:l,point:B.clone(),object:e}}function U(e,t,n,r,i,a,o,l,u,d){e.getVertexPosition(l,P),e.getVertexPosition(u,F),e.getVertexPosition(d,I);let f=H(e,t,n,r,P,F,I,z);if(f){let e=new s;O.getBarycoord(z,P,F,I,e),i&&(f.uv=O.getInterpolatedAttribute(i,l,u,d,e,new c)),a&&(f.uv1=O.getInterpolatedAttribute(a,l,u,d,e,new c)),o&&(f.normal=O.getInterpolatedAttribute(o,l,u,d,e,new s),f.normal.dot(r.direction)>0&&f.normal.multiplyScalar(-1));let t={a:l,b:u,c:d,normal:new s,materialIndex:0};O.getNormal(P,F,I,t.normal),f.face=t,f.barycoord=e}return f}var W=class e extends p{constructor(e=1,t=32,n=16,r=0,i=Math.PI*2,a=0,o=Math.PI){super(),this.type=`SphereGeometry`,this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));let c=Math.min(a+o,Math.PI),l=0,u=[],d=new s,f=new s,p=[],h=[],g=[],_=[];for(let s=0;s<=n;s++){let p=[],m=s/n,v=0;s===0&&a===0?v=.5/t:s===n&&c===Math.PI&&(v=-.5/t);for(let n=0;n<=t;n++){let s=n/t;d.x=-e*Math.cos(r+s*i)*Math.sin(a+m*o),d.y=e*Math.cos(a+m*o),d.z=e*Math.sin(r+s*i)*Math.sin(a+m*o),h.push(d.x,d.y,d.z),f.copy(d).normalize(),g.push(f.x,f.y,f.z),_.push(s+v,1-m),p.push(l++)}u.push(p)}for(let e=0;e<n;e++)for(let r=0;r<t;r++){let t=u[e][r+1],i=u[e][r],o=u[e+1][r],s=u[e+1][r+1];(e!==0||a>0)&&p.push(t,i,s),(e!==n-1||c<Math.PI)&&p.push(i,o,s)}this.setIndex(p),this.setAttribute(`position`,new m(h,3)),this.setAttribute(`normal`,new m(g,3)),this.setAttribute(`uv`,new m(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(t){return new e(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}};export{k as n,W as r,V as t};