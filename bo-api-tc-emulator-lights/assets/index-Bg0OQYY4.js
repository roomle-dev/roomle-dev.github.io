(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();(function(o,e){typeof exports=="object"&&typeof module<"u"?module.exports=e():typeof define=="function"&&define.amd?define(e):(o=typeof globalThis<"u"?globalThis:o||self).uuidv4=e()})(void 0,function(){var o,e=new Uint8Array(16);function t(){if(!o&&!(o=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(e)}var r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function a(n){return typeof n=="string"&&r.test(n)}for(var s=[],l=0;l<256;++l)s.push((l+256).toString(16).substr(1));return function(n,i,c){var d=(n=n||{}).random||(n.rng||t)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,i){c=c||0;for(var g=0;g<16;++g)i[c+g]=d[g];return i}return function(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=(s[u[h+0]]+s[u[h+1]]+s[u[h+2]]+s[u[h+3]]+"-"+s[u[h+4]]+s[u[h+5]]+"-"+s[u[h+6]]+s[u[h+7]]+"-"+s[u[h+8]]+s[u[h+9]]+"-"+s[u[h+10]]+s[u[h+11]]+s[u[h+12]]+s[u[h+13]]+s[u[h+14]]+s[u[h+15]]).toLowerCase();if(!a(_))throw TypeError("Stringified UUID is invalid");return _}(d)}});const v={enableArrangementCorrection:!0,uiConfiguration:{userRight:"Simple",materialAttributes:[".*Color.*"],attributesVisibleInPlanner:[],attributeGroupsVisibleInPlanner:[],showPossibleSubModules:!0,animatedOpenClose:!1},materialConfiguration:{defaultMaterial:"roomle_script_test:gray_transparent",replaceUnmappedMaterialsWithDefault:!1,materialMapping:[{materialName:"326",materialId:"egger:f235_st76"},{materialName:"Milchglas",materialId:"cabinetlibrary:frosted_glass"},{materialName:"Oven",materialId:"cabinetlibrary:oven"},{materialName:"BrassPlatedAntique",materialId:"egger:f302_st87"},{materialName:"NickelPlated",materialId:"egger:f765_st20"},{materialName:"StainlessSteelMattBrushed",materialId:"egger:f765_st20"},{materialName:"Grey",materialId:"egger:u708_st9"},{materialName:"Black",materialId:"egger:u999_st7"},{materialName:"seidenweiÃŸ",materialId:"egger:w980_st7"},{materialName:"oriongrau",materialId:"egger:u960_st9"},{materialName:"carbonschwarz",materialId:"egger:u999_st7"},{materialName:"Edelstahl",materialId:"egger:f765_st20"},{materialName:"metal",materialId:"egger:f765_st20"},{materialName:"196",materialId:"egger:u960_st9"},{materialName:"178",materialId:"egger:u708_st9"},{materialName:"380",materialId:"egger:f800_st9"},{materialName:"324",materialId:"egger:f244_st76"},{materialName:"316",materialId:"egger:f186_st9"},{materialName:"240",materialId:"egger:h3190_st19"},{materialName:"230",materialId:"egger:h3860_st9"},{materialName:"229",materialId:"egger:h1199_st12"},{materialName:"222",materialId:"egger:h2033_st10"},{materialName:"215",materialId:"egger:h1715_st12"},{materialName:"214",materialId:"egger:h3734_st9"},{materialName:"199",materialId:"egger:u999_st7"},{materialName:"190",materialId:"egger:w980_st7"},{materialName:"165",materialId:"egger:u645_st9"},{materialName:"160",materialId:"egger:u640_st9"},{materialName:"155",materialId:"egger:u575_st9"},{materialName:"152",materialId:"egger:u502_st9"},{materialName:"Klarglas",materialId:""},{materialName:"TestHalifax",materialId:"egger:h1181_st37"}]},debugConfiguration:{createDebugGeometry:!1},tecConfigInfo:{baseUrlDebug:"https://localhost:7125/",baseUrl:"https://europe-west3-rml-showcases.cloudfunctions.net/proxy_request?url=",libraryId:"Furniture_Smith"}},D=async(o,e,t)=>{const r={headers:{"Content-Type":e==="json"?"application/json":"text/plain","Access-Control-Allow-Origin":"*"}};v.tecConfigInfo.subscriptionId&&v.tecConfigInfo.key&&(r.headers.Authorization=`Basic ${btoa(v.tecConfigInfo.subscriptionId+":"+v.tecConfigInfo.key)}`);try{const a=performance.now(),s=v.tecConfigInfo.baseUrl,l=s+(s.includes("?")?encodeURIComponent(o):o),n=await fetch(l,r),c=performance.now()-a;if(!n.ok)throw x(`Failed to fetch data from ${t}`),new Error(`Failed to fetch data from ${o}: ${n.statusText}`);return x(`Success to fetch data from ${t}`),x(`The data for ${t} was fetched in ${c} milliseconds`),await n}catch(a){throw x(`Failed to fetch data from ${t}`),console.error(a),a}},J=(o,e,t)=>{let r=document.getElementById("console-log");const a=document.createElement("div");let s="";t&&t.forEach((l,n)=>{s+=l,n<t.length-1&&(s+=" ")}),a.innerText=o+": "+e+": "+s,r.children.length>0?r.insertBefore(a,r.children[0]):r.appendChild(a)},x=(o,...e)=>{console.log("LOG:",o,e),J("LOG",o,e)},y=o=>{console.log("API CALL:",o),J("API CALL",o,void 0)},p=(o,...e)=>{console.log("API CALLBACK:",o,e.length?e:void 0),J("API CALLBACK",o,e)};class de{constructor(){this.reRenders=0,this.queue=[],this.isProcessing=!1}async enqueue(e){let t,r;const a=new Promise((s,l)=>{t=s,r=l});return this.queue.push({renderFn:e,resolve:t,reject:r}),this.isProcessing||this.processQueue(),a}async processQueue(){if(!this.isProcessing){for(this.isProcessing=!0;this.queue.length>0;){this.reRenders++,document.getElementById("re-renders-count").innerText=this.reRenders;const{renderFn:e,resolve:t,reject:r}=this.queue[0];try{const a=await e(this.reRenders);t(a)}catch(a){r(a)}finally{this.queue.shift()}}this.isProcessing=!1}}}const O=(o,e=window.location.search)=>new URLSearchParams(e).get(o)??null,ue="modulepreload",ge=function(o){return"/bo-api-tc-emulator-lights/"+o},q={},he=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),n=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(t.map(i=>{if(i=ge(i),i in q)return;q[i]=!0;const c=i.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${d}`))return;const g=document.createElement("link");if(g.rel=c?"stylesheet":ue,c||(g.as="script"),g.crossOrigin="",g.href=i,n&&g.setAttribute("nonce",n),document.head.appendChild(g),c)return new Promise((u,h)=>{g.addEventListener("load",u),g.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})}))}function s(l){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=l,window.dispatchEvent(n),!n.defaultPrevented)throw l}return a.then(l=>{for(const n of l||[])n.status==="rejected"&&s(n.reason);return e().catch(s)})};var me=Object.defineProperty,pe=(o,e,t)=>e in o?me(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,w=(o,e,t)=>pe(o,typeof e!="symbol"?e+"":e,t);class z{constructor(e,t,r,a){w(this,"_side"),w(this,"_incomingMessageBus",null),w(this,"_outgoingMessageBus",null),w(this,"_execMessage",null),this._side=e,this._incomingMessageBus=t,this._outgoingMessageBus=r,this._execMessage=a,this._incomingMessageBus&&this._incomingMessageBus.addEventListener("message",this._handleMessage.bind(this))}setOutgoingMessageBus(e){this._outgoingMessageBus=e}setMessageExecution(e){this._execMessage=e}sendMessage(e,t=[]){return new Promise((r,a)=>{if(this._incomingMessageBus===this._outgoingMessageBus)return r(void 0);const s=new MessageChannel;s.port1.onmessage=n=>{if(!n||!n.data)return s.port1.close(),s.port2.close(),a(new Error(this._side+" received message but response can not be interpreted"));let i;try{i=JSON.parse(n.data)}catch(c){return s.port1.close(),s.port2.close(),this._prepareError(c),a(c)}i.error?a(i.error):i.result!==void 0?r(i.result):r(void 0),s.port1.close(),s.port2.close()};let l="";try{l=JSON.stringify({message:e,args:t})}catch{return a(new Error(this._side+": can not create command because it is not JSON.stringify able"))}if(!this._outgoingMessageBus)return a(new Error(this._side+": outgoing bus not set yet"));this._outgoingMessageBus.postMessage(l,"*",[s.port2])})}_handleMessage(e){const t=e.ports&&Array.isArray(e.ports)&&e.ports.length>0?e.ports[0]:null;if(e.data&&t)try{const r=JSON.parse(e.data);if(!this._execMessage)return t.postMessage(JSON.stringify({error:this._side+" is not ready to handle messages"}));Array.isArray(r.args)||(r.args=[r.args]);const a=this._execMessage(r,e);if(a===void 0)return;a.then((s={})=>{let l,n;typeof s=="object"&&s!==null&&(l=s.error,n=s.result),l?t.postMessage(JSON.stringify({error:l})):n!==void 0?t.postMessage(JSON.stringify({result:n})):t.postMessage(JSON.stringify({result:s}))},s=>{t.postMessage(JSON.stringify({error:this._prepareError(s)}))})}catch(r){t.postMessage(JSON.stringify({error:this._prepareError(r)}))}}_prepareError(e){if(typeof e=="string"){const t=this._side+": "+e;return console.error(t),t}return e.message=this._side+": "+e.message,console.error(e),e.message}}const T=".",j={REQUEST_BOOT:"requestBoot",SETUP:"setup",WEBSITE_READY:"websiteReady"},P={GET_METHODS:"getMethods",RETURN_METHODS:"returnMethods",REGISTER_CUSTOM_VIEW:"registerCustomView",REGISTER_CUSTOM_VIEW_DONE:"registerCustomViewDone"},fe=async(o,e)=>{if(typeof o!="string")throw new Error('Configurator ID is not a string type: "'+typeof o+'"');const t=e.customApiUrl?e.customApiUrl:"https://api.roomle.com/v2",r=e.overrideTenant||9,a=t+"/configurators/"+o,s="roomle_portal_v2",l="03-"+window.btoa(new Date().toISOString()+";anonymous;"+s),n=()=>{const g={apiKey:s,currentTenant:r,locale:"en",language:"en",device:1,token:l,platform:"web"};return new Headers(g)},i=new Request(a,{method:"GET",headers:n(),mode:"cors",cache:"default"}),c=await fetch(i),{configurator:d}=await c.json();return d},we=()=>{try{return window.self!==window.top}catch{return!0}},ye=["127.0.0.1","localhost","0.0.0.0"],be=()=>{const o=we();let e=window.location.href;if(o){if(!document.referrer)return null;e=document.referrer}const{hostname:t}=new URL(e);return t},Ee=o=>!!(ye.includes(o)||o.endsWith("roomle.com")||o.endsWith("gitlab.io")||o.endsWith("gitlab.com")),W=["language","browserLanguage","userLanguage","systemLanguage"],_e=(o=null)=>{const e=window.navigator;if(o)return o.substr(0,2);if(Array.isArray(e.languages)&&e.languages.length>0)return e.languages[0].substr(0,2);for(let t=0,r=W.length;t<r;t++){const a=e[W[t]];if(a)return a.substr(0,2)}return"en"},ve=(o,e)=>{const t=JSON.parse(JSON.stringify(o));return B(t,e)},B=(o,e)=>{for(const t in e)try{e[t].constructor===Object?o[t]=B(o[t],e[t]):o[t]=e[t]}catch{o[t]=e[t]}return o};var Ie={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};const Se={mobileLandscape:!0,floorMaterialRootTag:"materials_root",buttons:{renderimage:!0,requestproduct:!0,requestplan:!0,load_product:!0,partlist_print:!0},helpcenter:{roomdesigner:!0,configurator:!1,disable:!1},firstPersonView:!0,saveToIdb:!0,featureFlags:{mocAr:!0,wallAutoHeight:!1},rotationSnapDegrees:10},Oe="(idle)",xe=o=>(A(o),o!=null&&o.customApiUrl&&(o.customApiUrl=decodeURIComponent(o.customApiUrl)),o.shareUrl&&(o.deeplink=o.shareUrl.replace(Pe,De)),o),A=o=>{if(!o)return;const e=Object.keys(o);for(const t of e){const r=o[t];if(!Array.isArray(r)&&typeof r=="object"&&r!==null&&A(r),Array.isArray(r))for(const a of r)A(a);(r==="true"||r==="false")&&(o[t]=r==="true")}},Ce=(o,e)=>{e.configuratorId=o.id;const t=o.settings||{};return!e.overrideTenant&&o.tenant&&(e.overrideTenant=o.tenant),ve(t,e)},Me=()=>{const o={...Se};o.locale||(o.locale=_e()),o.id===Oe&&delete o.id;const e=be();return e&&Ee(e)&&(o.configuratorId="demoConfigurator"),o.customApiUrl=Ie.VITE_RAPI_URL,o.emails=!1,o},Pe="<CONF_ID>",De="#CONFIGURATIONID#",Y=()=>/(android)/i.test(navigator.userAgent);class Q{constructor(){w(this,"_messageHandler",null),w(this,"isSetupDone",!1),w(this,"viewName","main"),w(this,"plugins",{}),w(this,"pluginsLoaded",[]),w(this,"ui",{callbacks:null}),w(this,"extended",{callbacks:null}),w(this,"configurator",{callbacks:null}),w(this,"analytics",{callbacks:{}}),w(this,"global",{callbacks:{}})}setMessageHandler(e){this._messageHandler=e}handleSetup(e){const{methods:t,callbacks:r}=e;t.forEach(a=>{const s=a.split(T),l=s[0],n=s[1];this[l]||(this[l]={}),this[l][n]=(function(){if(!this._messageHandler){console.error("MessageHandler not set");return}return this._messageHandler.sendMessage(a,[...arguments])}).bind(this)}),r.forEach(a=>{const s=a.split(T),l=s[0],n=s[1],i=s[2];this[l]||(this[l]={}),this[l][n]||(this[l][n]={}),this[l][n][i]=()=>{}}),this.isSetupDone=!0}executeMessage({message:e,args:t}){const r=e.split(T),a=r[0],s=r[1],l=r.length===3?r[2]:null;if(l&&this[a][s][l]){const n=this[a][s][l](...t);return n instanceof Promise?n.then(i=>({result:i})):n!==void 0?Promise.resolve({result:n}):Promise.resolve({result:null})}return Promise.reject('Message "'+e+'" is unkown')}setupPlugins(e,t,r="website"){for(const a of e)typeof a=="string"&&a==="dragIn"?this.pluginsLoaded.push(new Promise((s,l)=>{try{he(()=>import("./drag-in-CYmR1HFI-C_SBxheq.js"),[]).then(n=>n.l).then(({DragIn:n})=>{const i=new n(this.ui,t,r,this.viewName);i.init().then(()=>{this.plugins.dragIn=i,s()},l)})}catch(n){l(n)}})):a.name&&a.loader&&this.pluginsLoaded.push(new Promise((s,l)=>{try{a.loader().then(n=>{const i=new n(this.ui,t,r,this.viewName);i.init().then(()=>{this.plugins[a.name]=i,s()},l)})}catch(n){l(n)}}))}}const K=()=>{let o,e;return{promise:new Promise((t,r)=>{o=t,e=r}),resolve:o,reject:e}},Z=(o,e,t)=>{let r=null;Object.defineProperty(o,e,{get(){return r||t},set(a){a!=null&&a.mute?r=a.value:(console.warn("You override Roomle defined behaviour. To disalbe this warning pass in an object with the following properties"),console.warn("{ mute: true, value: () => void }"),r=a)}})},se=()=>window.innerHeight*.01+"px",X=o=>{o&&setTimeout(()=>o.style.setProperty(U,se()),0)},ee="rml-styles",Ne=450,U="--rml-full-height",b={CONTAINER:"rml-container",FILL:"rml-fill",POSITION:"rml-pos",TRANSITION:"rml-transition",ANDROID_HEIGHT:"rml-android-height",OVERFLOW_HIDDEN:"rml-overflow-hidden"},G=new Map;class ne extends Q{constructor(e,t,r,a,s){if(super(),w(this,"_waitForIframe"),w(this,"_container"),w(this,"_configuratorSettings"),w(this,"_initData",{}),w(this,"_iframe"),!e||typeof e.id!="string")throw new Error("Please provide a correct configuratorId, you get the correct ID from your Roomle Contact Person");if(G.has(t))throw new Error("There is already an instance on this DOM element");if(!document.getElementById(ee)){const i=r.zIndex||9999999,c=document.createElement("style");c.type="text/css",c.id=ee;const d="transition:all ease-in-out "+Ne+"ms;",g=["-webkit-","-o-"].reduce((h,_)=>h+=_+d,"")+d,u=se();c.innerHTML=`
        .${b.CONTAINER}{${U}:${u};}
        .${b.POSITION}{position:fixed;top:0;left:0;z-index:${i};opacity:0}
        .${b.TRANSITION}{${g}}
        .${b.FILL}{width:100%;height:100%;opacity:1}
        .${b.ANDROID_HEIGHT}{height:calc(var(${U},1vh)*100)}
        .${b.OVERFLOW_HIDDEN}{overflow:hidden}
      `,document.head.appendChild(c)}this._executeMessage=this._executeMessage.bind(this);const l=new z("website",window,null,this._executeMessage);this.setMessageHandler(l),this._onResize=this._onResize.bind(this),Y()&&window.addEventListener("resize",this._onResize),this._container=t,this._initData=r,this._configuratorSettings=e;const n=this._createIframe();this._onUseFullPage=this._onUseFullPage.bind(this),this._onBackToWebsite=this._onBackToWebsite.bind(this),this._waitForIframe=s,this._container.appendChild(n),this._iframe=n,this.setupPlugins(a,this._iframe),G.set(t,!0)}static createPlanner(e,t,r,a=[]){return this._create(e,t,r,a)}static async connect(e,t=[]){const r=new Q;r.viewName=e;const{resolve:a,promise:s}=K(),{resolve:l,promise:n}=K(),i=({message:g,args:u})=>{switch(g){case P.REGISTER_CUSTOM_VIEW_DONE:a();break;case P.RETURN_METHODS:r.handleSetup(u[0]),l();break;default:if(r.isSetupDone)return r.executeMessage({message:g,args:u})}},c=new z("custom-view-"+e,window,window.parent,i);r.setMessageHandler(c);const d=[e];return c.sendMessage(P.REGISTER_CUSTOM_VIEW,d),await s,c.sendMessage(P.GET_METHODS,d),await n,r.setupPlugins(t,document.body,"custom-view"),await Promise.allSettled(r.pluginsLoaded),r}static createConfigurator(e,t,r,a=[]){return this._create(e,t,r,a)}static create(e,t,r,a){return this._create(e,t,r,a)}static createViewer(e,t,r,a=[]){return this._create(e,t,r,a)}static async _create(e,t,r,a){return new Promise(async(s,l)=>{try{const n=B(Me(),xe(r));n.featureFlags||(n.featureFlags={}),typeof n.featureFlags.realPartList!="boolean"&&(n.featureFlags.realPartList=!0),typeof n.featureFlags.globalCallbacks!="boolean"&&(n.featureFlags.globalCallbacks=!0),typeof n.featureFlags.mocAr!="boolean"&&(n.featureFlags.mocAr=!1);const i=await fe(e,n);r=Ce(i,n);const c=new this(i,t,r,a,s);return await Promise.allSettled(c.pluginsLoaded),c}catch(n){return l(n)}})}teardown(){this._container&&G.delete(this._container);const e=this._container.querySelector("iframe");e&&this._container.removeChild(e),window.removeEventListener("resize",this._onResize)}_createIframe(){var e;const t=document.createElement("iframe");let r=((e=this._configuratorSettings)==null?void 0:e.url)||"https://www.roomle.com/t/cp/";return this._initData.useLocalRoomle&&(r=location.href.replace("embedding.html","")),location.href.includes("roomle.gitlab.io")&&(r=location.href.replace("embedding.html","index.html")),this._initData.overrideServerUrl&&(r=this._initData.overrideServerUrl),t.src=r,t.classList.add(b.CONTAINER),t.classList.add(b.FILL),t}_onResize(){X(this._iframe)}_onUseFullPage(){this._iframe.classList.add(b.POSITION),document.documentElement.classList.add(b.OVERFLOW_HIDDEN),window.document.body.classList.add(b.OVERFLOW_HIDDEN),Y()&&(X(this._iframe),this._iframe.classList.add(b.ANDROID_HEIGHT))}_onBackToWebsite(){this._iframe.classList.remove(b.POSITION),this._iframe.classList.remove(b.ANDROID_HEIGHT),document.documentElement.classList.remove(b.OVERFLOW_HIDDEN),window.document.body.classList.remove(b.OVERFLOW_HIDDEN)}_executeMessage({message:e,args:t},r){var a;if(r.source&&r.source===((a=this._iframe)==null?void 0:a.contentWindow))return e===j.REQUEST_BOOT?this._messageHandler?(this._messageHandler.setOutgoingMessageBus(r.source),Promise.resolve({result:this._initData})):(console.error("MessageHandler not set"),Promise.resolve({error:"MessageHandler not set"})):e===j.SETUP?(this.handleSetup(t[0]),Z(this.ui.callbacks,"onUseFullPage",this._onUseFullPage),Z(this.ui.callbacks,"onBackToWebsite",this._onBackToWebsite),this._waitForIframe(this),setTimeout(()=>{if(!this._messageHandler){console.error("MessageHandler not set");return}this._messageHandler.sendMessage(j.WEBSITE_READY)},0),Promise.resolve({result:null})):this.executeMessage({message:e,args:t})}}const Re=async(o,e)=>await ne.createPlanner("bo-api-tc-emulator",o,e,["dragIn"]),ke=async(o,e)=>await ne.createPlanner("bo-api-tc-emulator",o,e),ie=(o,e)=>{if(!o){console.warn("Roomle Planner not initialized yet");return}y("configureExternalObjectApi"),o.extended.configureExternalObjectApi(e)},le=(o,e)=>{if(!o){console.warn("Roomle Planner not initialized yet");return}y("loadExternalObjectLibrary"),o.extended.loadExternalObjectLibrary(e)},C=async(o,e,t,r,a=[])=>{if(!o)throw new Error("Roomle Planner not initialized yet");const s=Array.isArray(e)?e:[e];let l="";for(const n of s)l+=` '${n.id}'`;y(`loadExternalObjectGroup${l}`),await o.extended.loadExternalObjectGroup(s,t,r,a)},Te=async(o,e,t=!1)=>{if(!o)throw new Error("Roomle Planner not initialized yet");y(`removeExternalObjectGroup '${e}' ${t}`),await o.extended.removeExternalObjectGroup(e,t)},je=async(o,e)=>{if(!o)throw new Error("Roomle Planner not initialized yet");y(`removeExternalObjectRootModule '${e}'`),await o.extended.removeExternalObjectRootModule(e)},Ge=async(o,e,t,r,a)=>{if(!o)throw new Error("Roomle Planner not initialized yet");y(`openCloseExternalObject '${e}' '${t}' ${r?"open":"close"}`),await o.extended.openOrCloseGeometryOfExternalObject(e,0,r,a)},Le=async(o,e)=>{if(!o)throw new Error("Roomle Planner not initialized yet");y(`selectExternalObjectGroup '${e}'`),await o.extended.selectExternalObjectGroup(e)},Ae=async(o,e)=>{if(!o)throw new Error("Roomle Planner not initialized yet");y(`selectExternalObjectRootModule '${e}'`),await o.extended.selectExternalObjectRootModule(e)},Ue=async(o,e,t)=>{if(!o)throw new Error("Roomle Planner not initialized yet");y(`selectExternalObjectSubModule '${e}' '${t}'`),await o.extended.selectExternalObjectSubModule(e,t)},$e=async()=>{const o=await roomDesignerApi.extended.getExternalObjectGroups(),e=o.map(t=>t.id);return y(`getPosDataOfAllGroups => '${e}'`),o},Je=async o=>{if(!o)throw new Error("Roomle Planner not initialized yet");y("saveExternalObjectSnapshot");const e=await o.extended.saveExternalObjectSnapshot();window.open(e.glb,"_blank").focus()},Be=o=>`(${o[0].toFixed(1)}, ${o[1].toFixed(1)}, ${o[2].toFixed(1)})`,Fe=o=>`${(o==null?void 0:o.toFixed(1))??0}Â°`,He=(o,e)=>{o.extended.callbacks.onMergeExternalObjectGroup=(t,r,a)=>{p(`onMergeExternalObjectGroup ${t} ${r}, ${a}`),e.mergeGroups(t,r,a)},o.extended.callbacks.onSplitExternalObjectGroup=(t,r)=>{p("onSplitExternalObjectGroup",JSON.stringify(t),JSON.stringify(r)),e.splitRootModuleFromGroup(t,r)},o.extended.callbacks.onExternalObjectGroupArrangementChanged=t=>{p("onExternalObjectGroupArrangementChanged",JSON.stringify(t)),e.arrangeRootModulesOfGroup(t)},o.extended.callbacks.onDeleteExternalObjectGroup=t=>{p(`onDeleteExternalObjectGroup ${t}`),e.removedGroup(t)},o.extended.callbacks.onDeleteExternalObjectRootModule=(t,r,a)=>{p("onDeleteExternalObjectRootModule",JSON.stringify(t),r,JSON.stringify(a)),e.deleteRootModule(t,r,a)},o.extended.callbacks.onDeleteExternalObjectSubModule=(t,r)=>{p(`onDeleteExternalObjectSubModule ${t} ${r}`)},o.extended.callbacks.onDuplicateExternalObjectGroup=(t,r)=>{p(`onDuplicateExternalObjectGroup ${t}, ${r}`),e.duplicateGroup(t,r)},o.extended.callbacks.onChangedExternalObjectGroupPlan=t=>{p("onChangedExternalObjectGroupPlan",t.groupId,Be(t.pos),Fe(t.rotation))},o.extended.callbacks.onExternalObjectEnvironmentChanged=(...t)=>{p("onExternalObjectEnvironmentChanged",t)},o.extended.callbacks.onExternalObjectGroupChanged=t=>{const r=JSON.parse(t);p("onExternalObjectGroupChanged",r.id),e.changedGroup(r)},o.extended.callbacks.onExternalObjectGroupLoaded=t=>{const r=JSON.parse(t);p("onExternalObjectGroupLoaded",r.id),e.loadedGroup(r)},o.extended.callbacks.onExternalObjectAttributeChanged=(...t)=>{p("onExternalObjectAttributeChanged",t),e.modifyAttribute(...t)},o.extended.callbacks.onPlanSnapshotCreated=(...t)=>{p("onPlanSnapshotCreated",t)}},te=1;class Ve{constructor(e,t){this.roomDesignerApi=e,this.uiContainer=t,this.posDataJsonMap=new Map,this.groupMap=new Map,this.nextPosDataId=1}loadPosData(e){e.forEach(t=>{this.posDataJsonMap.set(t.id,{libraryId:v.tecConfigInfo.libraryId,id:t.id,roots:t.roots})})}newPosDataFromId(e){const t=JSON.parse(JSON.stringify(this.posDataJsonMap.get(e)));return t?(t.ver=te,this._addNewGroup(t,!1).posDataJson):void 0}async deleteGroup(e,t=!1){try{this.removedGroup(e),await Te(this.roomDesignerApi,e,t)}catch(r){console.error(r)}}async selectGroup(e){try{await Le(this.roomDesignerApi,e)}catch(t){console.error(t)}}async selectRoot(e,t){try{await Ae(this.roomDesignerApi,t)}catch(r){console.error(r)}}async deleteRoot(e,t){try{await je(this.roomDesignerApi,t)}catch(r){console.error(r)}}async selectSubModule(e,t,r){try{await Ue(this.roomDesignerApi,t,r)}catch(a){console.error(a)}}async openCloseGroup(e){try{const t=this.groupMap.get(e),r=!t.opened;await Ge(this.roomDesignerApi,e,null,r,!1),t.opened=r}catch(t){console.error(t)}}deleteRootModule(e,t,r){try{if(this.groupMap.has(e.groupId)){const a=this.groupMap.get(e.groupId);this._setGroupPosition(a,e);const s=a.posDataJson;s.roots=s.roots.filter(n=>n.id!==t);const l=this._spitOffGroupsFromGroups(a,r);this._calculateAndUpdateGroupMap(a),this._loadPosData(a,l)}}catch(a){console.error(a)}}duplicateGroup(e,t){try{if(this.groupMap.has(e)){const r=this.groupMap.get(e),a=JSON.parse(JSON.stringify(r.posDataJson)),s=this._addNewGroup(a,!1);this._setGroupPosition(s,t),C(this.roomDesignerApi,s.posDataJson,!0,!1)}}catch(r){console.error(r)}}mergeGroups(e,t,r){try{const a=Array.isArray(t)?t:[t];if(this.groupMap.has(e.groupId)&&a.length>0){const s=this.groupMap.get(e.groupId);for(const l of a)if(this.groupMap.has(l)){const n=this.groupMap.get(l);s.posDataJson.roots.push(...n.posDataJson.roots)}this._setGroupPosition(s,e),this._setRootModulesPosition(s,e),this._calculateAndUpdateGroupMap(s),C(this.roomDesignerApi,s.posDataJson,!1,!1,a)}}catch(a){console.error(a)}}splitRootModuleFromGroup(e,t){try{if(this.groupMap.has(e.groupId)){const r=this.groupMap.get(e.groupId);this._setGroupPosition(r,e),this._setRootModulesPosition(r,e);const a=Array.isArray(t)?t:[t],s=this._spitOffGroupsFromGroups(r,a);this._calculateAndUpdateGroupMap(r),this._loadPosData(r,s)}}catch(r){console.error(r)}}arrangeRootModulesOfGroup(e){try{if(this.groupMap.has(e.groupId)){const t=this.groupMap.get(e.groupId);for(const r of t.posDataJson.roots)e.rootModules.filter(a=>a.moduleId===r.id).forEach(a=>{r.articlePos=a.pos,r.rotationY=a.rotationY});C(this.roomDesignerApi,t.posDataJson,!1,!1)}}catch(t){console.error(t)}}removedGroup(e){this._clearUiELements();try{this.groupMap.has(e)&&this.groupMap.delete(e)}catch(t){console.error(t)}this._createUiElements()}changedGroup(e){try{const t=e.id;if(this.groupMap.has(t)){const r=this.groupMap.get(t);r.posDataJson=e}else this._addGroupToMap(t,e)}catch(t){console.error(t)}}loadedGroup(e){try{const t=e.id;this.groupMap.has(t)||this._addGroupToMap(t,e)}catch(t){console.error(t)}}calculateCatalogPosData(e){const t=JSON.parse(JSON.stringify(this.posDataJsonMap.get(e.id)));return t.ver=te,this._calculateNewGroup(t,!1)}async getOrderManagerGroupData(e){try{const t=await $e();return window.exports.getOrderData(t,e)}catch(t){console.error(t)}}_setGroupPosition(e,t){const r=e.posDataJson;t.pos!==void 0&&(r.pos=t.pos),t.rotationY!==void 0&&(r.rotationY=t.rotationY)}_setRootModulesPosition(e,t){for(const r of e.posDataJson.roots)t.rootModules.filter(a=>a.moduleId===r.id).forEach(a=>{r.articlePos=a.pos,r.rotationY=a.rotationY})}_loadPosData(e,t){const r=JSON.parse(JSON.stringify(e.posDataJson)),a=Array.isArray(r)?r:[r];for(const s of t??[])a.push(JSON.parse(JSON.stringify(s.posDataJson)));C(this.roomDesignerApi,a,!1,!1)}_spitOffGroupsFromGroups(e,t){const r=[];for(const a of t??[]){const s=this._spitOffRootModulesFromGroup(e,a),l=this._addNewGroup(s,!0);r.push(l)}return r}_spitOffRootModulesFromGroup(e,t){const r=t.rootModules.map(n=>n.moduleId),a=e.posDataJson,s=a.roots.filter(n=>r.includes(n.id));a.roots=a.roots.filter(n=>!r.includes(n.id));const l={pos:t.pos,rotationY:t.rotationY,roots:s,ver:a.ver};for(const n of l.roots)t.rootModules.filter(i=>i.moduleId===n.id).forEach(i=>{n.articlePos=i.pos,n.rotationY=i.rotationY});return l}_calculateNewGroup(e,t){return this._replacesIDs(e,t),this._calculate(e)}_calculate(e){y(`calc '${e.id}' ${e.ver}`);const t=window.exports.calc(e);return console.log(t),t}_calculateAndUpdateGroupMap(e){this._clearUiELements();let t=this._calculate(e.posDataJson);return e.posDataJson=t,this.groupMap.set(e.posDataJson.id,e),this._createUiElements(),t}_addNewGroup(e,t){const r=this._calculateNewGroup(e,t);return this._addGroupToMap(r.id,r)}_addGroupToMap(e,t){const r={posDataJson:t,opened:!1,uiElements:[]};return this._clearUiELements(),this.groupMap.set(e,r),this._createUiElements(),r}modifyAttribute(e,t,r,a){if(this.groupMap.has(e)){const l=this.groupMap.get(e),n=l.posDataJson;var s=this._findModule(n.roots,t);if(s){let i=!1;for(const d of s.attributes)if(d.id===r){d.value=a,d.isInput=!0,i=!0;break}i||s.attributes.push({id:r,value:a,isInput:!0});let c=this._calculateAndUpdateGroupMap(l);C(this.roomDesignerApi,c,!1,!0)}}}_findModule(e,t){for(const r of e){if(r.id===t)return r;if(r.modules)return this._findModule(r.modules,t)}}_replacesIDs(e,t){if(e.id=this._getNextID(),!t)for(const r of e.roots)r.id=this._getNextID()}_getNextID(){let e=(this.nextPosDataId++).toString();return e.length<4&&(e="0".repeat(4-e.length)+e),"id"+e}_addUiElements(e,t){const r=t.posDataJson,a=r.roots;t.uiElements.push(this._addButton("select","groupâžš",e,()=>this.selectGroup(e))),a.forEach(s=>{t.uiElements.push(this._addButton("select","rootâžš",s.id,()=>this.selectRoot(e,s.id))),t.uiElements.push(this._addButton("delete","ðŸ—‘",s.id,()=>this.deleteRoot(e,s.id))),s.modules&&s.modules.forEach(l=>{t.uiElements.push(this._addButton("select","subâžš",s.id+"/"+l.id,()=>this.selectSubModule(e,s.id,l.id)))})}),JSON.stringify(r).includes("openFullMatrix")&&t.uiElements.push(this._addButton("open","ðŸšª",e,()=>this.openCloseGroup(e))),t.uiElements.push(this._addButton("delete","ðŸ—‘",e,()=>this.deleteGroup(e)))}_removeUiElements(e){if(this.groupMap.has(e)){const t=this.groupMap.get(e);for(const r of t.uiElements)r.remove()}}_addButton(e,t,r,a){const s=document.createElement("button");return s.id=e+"-"+r,s.textContent=`${t} ${r}`,s.addEventListener("click",a),this.uiContainer.appendChild(s),s}_clearUiELements(){this.groupMap.forEach((e,t)=>{this._removeUiElements(t)})}_createUiElements(){this.groupMap.forEach((e,t)=>{this._addUiElements(t,e)})}}const N=[],$=new Map;let L=null;const qe=async(o,e,t=!0)=>{const r=v.tecConfigInfo.libraryId;L||(L=await(await D(`api/pos/articles?libraryId=${r}`,"json","articles-catalog")).json());const a=[{imageUrl:"https://catalog.roomle.com/1e9dbe16-bb11-446a-a28d-1cc42a3c16e4/items/frame/perspectiveimage.png?marker=1516698938",rmlId:"usm:frame"}];[...L,...a].forEach(s=>{const l=document.createElement("div"),n=document.createElement("img");l.appendChild(n);const i=document.createElement("div");l.appendChild(i);let c=!1;if(s.imageUrl?n.src=s.imageUrl:$.has(s.id)?n.src=$.get(s.id):(n.src="https://dfcorecdn.homag.cloud/images/material-icons/document.svg",c=!0),n.height=100,n.title=s.id,n.draggable=t,i.innerText=s.name,i.style.textAlign="center",s.rmlId?n.setAttribute("data-rml-id",s.rmlId):(n.setAttribute("data-src",s.id),n.setAttribute("data-type","tc_id")),o.style.display="flex",o.style.flexWrap="wrap",o.appendChild(l),e&&c){const d=s.id,g=e.calculateCatalogPosData(s);N.push({posDataJson:g,catalogElement:l,imageElement:n,articleId:d})}})},ze=async(o,e,t)=>{if(N.length===0)return;const r=[...N];N.length=0;const a=document.getElementById("designer-container"),s=document.createElement("div");s.style.position="absolute",s.style.top="0",s.style.right="0",s.style.width="200px",s.style.height="200px",s.id="render-catalog-images",a.appendChild(s);const n=await ke(s,{overrideServerUrl:o,customApiUrl:"https://api.roomle.com/v2",featureFlags:{boPoC:!0,boPoCDebug:!1},moc:!0});ie(n,e),le(n,t),await n.extended.loadPlan("ps_wkgft2wic6icffr28jbk9ta9aft15mq");for(const i of r){const c=await n.extended.renderImagesOfExternalObjectGroup(i.posDataJson);for(const d in c)if(c.hasOwnProperty(d)){const g=c[d];i.imageElement.src=g,$.set(i.articleId,g)}}a.removeChild(s)},m={selection:{type:null,payload:null,parameters:[]},currentContext:"planner",currentCustomView:null,currentSidebar:null,abortController:new AbortController,isBuildingCatalog:null,waitForCatalog:()=>m.isBuildingCatalog?new Promise(o=>{m.isBuildingCatalog.then(()=>{o(),m.isBuildingCatalog=null})}):Promise.resolve()},oe=()=>{m.selection.type=null,m.selection.payload=null,m.selection.parameters=[]},We=(o,e,t,r)=>{if(!o){console.warn("Roomle Planner not initialized yet");return}const a=u=>{let h=u.target.getAttribute("data-type");return{id:u.target.getAttribute("data-src"),type:h}},s=u=>{const{id:h,type:_}=a(u);if(y(`dragStart-${h}`),_==="tc_id"&&window.parent.parent.emulator){const I=window.parent.parent.emulator.newPosDataFromId(h);o.plugins.dragIn.dragStart(I,u,"tc_serialized")}},l=()=>{y("dragEnd"),o.plugins.dragIn.dragEnd()},n=u=>{o.plugins.dragIn.dragUpdate(u)},i=u=>{const{id:h,type:_}=a(u);y(`touchStart-${h}`),o.plugins.dragIn.touchStart(h,u,_)},c=u=>{o.plugins.dragIn.touchMove(u)},d=u=>{y("touchEnd"),o.plugins.dragIn.touchEnd()},g=u=>{const h=u.target.getAttribute("data-rml-id");h?o.plugins.dragIn.dragStart(h,u,"rml_id"):window.TouchEvent&&u instanceof TouchEvent?i(u):s(u)};e.forEach(u=>{u.setAttribute("data-rml-draggable","true")}),r?(r.addEventListener("dragstart",g,{signal:t}),r.addEventListener("dragend",l,{signal:t}),r.addEventListener("drag",n,{signal:t}),r.addEventListener("touchstart",g,{signal:t}),r.addEventListener("touchend",d,{signal:t}),r.addEventListener("touchmove",c,{signal:t})):o.plugins.dragIn.registerCustomDrag({customDragStart(u){g(u)},customDragEnd(u){window.TouchEvent&&u instanceof TouchEvent?d():l()},customDragUpdate(u){window.TouchEvent&&u instanceof TouchEvent?c(u):n(u)}})},E=()=>document.getElementById("overlay"),R=async()=>{const{final:o}=await roomDesignerApi.ui.getDrawerBoundingClientRect(),e=E();e.style.width=`${o.width}px`,e.style.height=`${o.height}px`,e.style.top=`${o.top}px`,e.style.left=`${o.left}px`,e.style.transform=""},F=()=>{E().classList.remove("hidden")},Ye=()=>{E().classList.add("hidden"),m.currentCustomView=null},Qe=async o=>{const{backgroundColor:e,cursor:t}=await o.ui.getPopUpShadowStyle(),r=E();let a=r.querySelector(".shadow");if(!a){const s=document.createElement("div");s.classList.add("shadow"),r.prepend(s)}a=r.querySelector(".shadow"),a.style.backgroundColor=e,a.style.cursor=t,a.style.position="absolute",a.style.top="1px",a.style.left="0",a.style.bottom="0",a.style.right="0",r.style.overflowY="hidden",a.addEventListener("click",()=>{o.ui.closePopUp()})},Ke=()=>{const o=E(),e=o.querySelector(".shadow");e&&e.remove(),o.style.overflowY="auto"},Ze=o=>{if(!o||o&&typeof o=="object"&&!o.groupId&&!o.rootModuleId&&!o.subModuleId)return console.warn("Unknown selection type, selectionPayload:",o),"Unknown selection type";if(o.groupId&&!o.rootModuleId&&!o.subModuleId)return"Group selection";if(o.groupId&&o.rootModuleId&&!o.subModuleId)return"Root module selection";if(o.groupId&&o.rootModuleId&&o.subModuleId)return"Sub module selection"},Xe=async()=>{m.currentCustomView="item-selection",await roomDesignerApi.ui.activateCustomView("item-selection",{}),E().innerHTML=`
                  <div style="font-family: sans-serif, Arial;">
                      <h2>No view for external object selection</h2>
                      <p style="padding: 0 1rem 0 1rem">
                        You are in POS mode but Roomle has no view defined if you select an external object.
                        In Roomle we fallback to current active mode (catalog, room or object-list). In case
                        the catalog is active you would see a blank side bar. For more details see 
                        <a href="https://roomle.atlassian.net/browse/RML-13555?atlOrigin=eyJpIjoiZTI5NGFhZjlhODVlNGE3ZTk3N2ZlZTFlYjk5MGY2YjciLCJwIjoiaiJ9" target="_blank" rel="noopener noreferrer">
                          RML-13555
                        </a>.
                        Probably Roomle will redefine this behavior in the future, then we can delete this message!
                      </p>
                  </div>
              `,F(),await R()},re=async(o,e,t)=>{var a,s,l;o.currentCustomView="item-selection",await e.ui.activateCustomView("item-selection",{});const r=Ze(o.selection.payload);E().innerHTML=`
    <div class="item" style="font-family: sans-serif, Arial;">
        <h2>Article configuration page</h2>
        <p>
          Type: ${r}<br>
          GroupId: ${(a=o.selection.payload)==null?void 0:a.groupId}<br>
          RootModuleId: ${(s=o.selection.payload)==null?void 0:s.rootModuleId}<br>
          SubModuleId: ${(l=o.selection.payload)==null?void 0:l.subModuleId}
        </p>
        <div>
          <p>Click-to-insert into room</p>
          <div class="click-to-insert">
          ${o.currentContext==="planner"?`
              <img src="https://dfcorecdn.homag.cloud/images/material-icons/document.svg" height="100" title="MyNewArticle" data-src="MyNewArticle" data-type="tc_id">
              <img src="https://dfcorecdn.homag.cloud/images/material-icons/document.svg" height="100" title="RA2" data-src="RA2" data-type="tc_id">
              <img src="https://dfcorecdn.homag.cloud/images/material-icons/document.svg" height="100" title="HH" data-src="HH" data-type="tc_id">`:`
              <strong>No click-to-insert into room of objects inside configurator (isolation mode)</strong>`}
          </div>  
        </div>
        <div class="parameters">
          <p><strong>Parameters</strong></p>
          <div>
            ${o.selection.parameters.map(n=>{let i=`${n.key}: ${n.value} (type: ${n.uiType})`;return n.uiType==="Options"?i+=`<br><select id="${n.key}">${n.validValues.map(({value:c})=>`<option>${c}</option>`).join("")}</select>`:n.uiType==="Range"&&(i+=`<br><input type="range" id="${n.key}" min="${n.validRange.valueFrom}" max="${n.validRange.valueTo}" value="${n.value}" step="${n.validRange.step}">`),`<div>${i}<hr></div>`}).join("")}
          </div>
        </div>
    </div>
  `,await R(),E().querySelectorAll(".click-to-insert img").forEach(n=>{n.addEventListener("click",async i=>{const c=i.target.getAttribute("data-src"),d=t.newPosDataFromId(c),g=Array.isArray(d)?d:[d];let u="";for(const h of g)u+=` '${h.id}'`;y(`loadExternalObjectGroup${u}`),await e.extended.loadExternalObjectGroup(g,!0,!1,[])})}),(E().querySelectorAll(".item .parameters")||[]).forEach(n=>{n.querySelectorAll("select").forEach(i=>{i.addEventListener("change",async c=>{const d=c.target.id,g=c.target.value;console.log("update parameter (type range) with key:",d,"and value:",g),await e.configurator.setParameter({key:d},g.toString())})}),n.querySelectorAll('input[type="range"]').forEach(i=>{i.addEventListener("change",async c=>{const d=c.target.id,g=c.target.value;console.log("update parameter (type input) with key:",d,"and value:",g),await e.configurator.setParameter({key:d},g.toString())})})}),F()},ae=async(o,e)=>{m.currentCustomView="ext-catalog",await o.ui.activateCustomView("ext-catalog",{});let t;m.isBuildingCatalog=new Promise(r=>{t=r}),E().innerHTML=`
                <div style="font-family: sans-serif, Arial;">
                    <h2>Custom catalog as overlay</h2>
                    <div class="items"></div>
                </div>
            `,F(),await R(),qe(E().querySelector(".items"),e).then(()=>{E().querySelectorAll(".items img").forEach(r=>{We(o,[],m.abortController.signal,r)}),t()})},M=async()=>(m.currentCustomView&&roomDesignerApi.ui.deactivateCustomView(m.currentCustomView,{}),await Ye()),et=async(o,e,t)=>{const r=new de,a=async(i,c,d)=>(console.log("UI-Render-Trace:",i,"(render count: "+(c||"outside of queue")+")"),await d()),s=async i=>await r.enqueue(async c=>{const d=i==null?void 0:i.force,g=i!=null&&i.debugString?i.debugString+" now show":"";return d==="catalog"?await a(g+" force custom catalog",c,()=>ae(o,e)):d==="roomle-view"?await a(g+" force roomle-view",c,()=>M()):m.selection.type==="tc-config"?t?m.currentContext==="planner"?await a(g+" item selection warning",c,()=>Xe()):await a(g+" roomle-view",c,()=>M()):await a(g+" custom item selection",c,()=>re(m,o,e)):m.selection.type==="rml-object"||m.selection.type==="multiselect"?await a(g+" roomle-view",c,()=>M()):m.currentSidebar==="catalog"||!m.currentSidebar?await a(g+" custom catalog",c,()=>ae(o,e)):await a(g+" roomle-view",c,()=>M())});o.extended.callbacks.onContextChanged=async i=>{p("onContextChanged",i),m.currentContext=i,m.currentContext==="planner"&&oe(),await s({debugString:"onContextChanged to "+i})},o.ui.callbacks.onExpandDrawer=()=>{const i=E();i.style.transform="",p("onExpandDrawer")},o.ui.callbacks.onCollapseDrawer=async()=>{p("onCollapseDrawer");const i=await o.ui.getDrawerAnimation(),c=E();c.style.transition=i.transition,c.style.transform="translate3d(100%, 0, 0)"},o.ui.callbacks.onSidebarEvent=async(i,c)=>{if(p("onSidebarEvent",i,c),i==="set-sidebar"){if(c==="room"||c==="productList")return m.currentSidebar=c,await s({debugString:"onSidebarEvent wants to open room or productList",force:"roomle-view"});if(c==="catalog")return m.currentSidebar=c,await s({debugString:"onSidebarEvent wants to open catalog",force:"catalog"})}};const l=async(i,c)=>{p("onSelectionCancel","initiated from",i,"reason",c),c!=="select_other"&&(oe(),await s({debugString:`selection cancel in ${i} (reason:${c})`}))},n=async(i,c,d,g)=>{if(console.log(g),p("onSelectionChange","initiated from",i,c,d,g),i==="configurator")return await s({debugString:"selection changed in "+i});if(c==="multiselect")return m.selection.type=c,await s({debugString:"selection changed but multiselect "+i});d==="external-configuration"&&g.externalConfigurationType==="tc-config"?m.selection.type=g.externalConfigurationType:(m.selection.type="rml-object",await s({debugString:"selection changed to rml-object "+i}))};o.extended.callbacks.onSelectionChange=async(i,c,d)=>{await n("planner",i,c,d)},o.extended.callbacks.onSelectionCancel=i=>l("planner",i),o.extended.callbacks.onExternalObjectSelectionCancel=()=>{p("onExternalObjectSelectionCancel")},o.extended.callbacks.onComponentSelectionCancel=()=>{p("onComponentSelectionCancel")},o.extended.callbacks.onExternalObjectModuleSelected=async(i,c,d)=>{m.selection.payload={groupId:i,rootModuleId:c,subModuleId:d},p(`onExternalObjectModuleSelected ${i} ${c} ${d}`),await s({debugString:"onExternalObjectModuleSelected"})},o.configurator.callbacks.onSelectionCancel=i=>{p("configurator.callbacks.onSelectionCancel","reason",i),m.currentContext==="configurator"&&(i==="click_outside"||i==="isolation_mode_cancelled"||l("configurator",i))},o.configurator.callbacks.onSelectionChange=(i,c,d)=>{p("configurator.callbacks.onSelectionChange","mode",i,"type",c,"payload",d),m.currentContext==="configurator"&&n("configurator",i,c,d)},o.configurator.callbacks.onUpdateParameters=async i=>{p("configurator.callbacks.onUpdateParameters"),m.selection.parameters=i},o.ui.callbacks.onButtonClicked=async i=>(i==="partlist"&&(m.currentCustomView?await a("roomle-view:partlist:show",null,()=>M()):await a("roomle-view:partlist:hide",null,()=>re(m,o,e))),!1),o.configurator.callbacks.onButtonClicked=async i=>(console.log("configurator.ui.callbacks.onButtonClicked",i),!1),o.ui.callbacks.onShowPopUp=async()=>{p("onShowPopUp"),Qe(o)},o.ui.callbacks.onHidePopUp=async()=>{p("onHidePopUp"),Ke()},window.addEventListener("resize",R),await s({debugString:"initial render"})},tt=performance.now(),ot=async()=>{const o=O("server_url")??"https://dev.roomle.com/t/web-sdk/1136/",e=O("plan_id")??"ps_8my9weye454hcdnze5snz3ljcoelius",t=O("catalog_images")??!1,r=O("debug")??!0,a=O("pos")??!1,s=O("library_id")??v.tecConfigInfo.libraryId;v.tecConfigInfo.libraryId=s;const l=async()=>await(await D(`api/pos/articles?libraryId=${s}`,"json","articles")).json(),n=async()=>await(await D(`api/pos/masterData?libraryId=${s}`,"json","masterData")).json(),i=async()=>{const f="api/pos/calc.js?libraryId="+encodeURIComponent(s),k=await(await D(f,"text","calc.js")).text();if(!k)throw new Error("Script load error");window.exports={};const S=new Blob([k],{type:"text/javascript"}),V=URL.createObjectURL(S);return await import(V),URL.revokeObjectURL(V),!0},c={extCatalog:{overlay:!0},itemSelection:{overlay:!0}},d={debug:!0,featureFlags:{openCloseAnimation:!0,slopingRoof:!0,interiorLights:!0}};o&&(d.overrideServerUrl=o),r&&(d.debugGeometry=r),a&&(c.itemSelection=null,delete c.itemSelection,d.customView=c);const[g,u,h]=await Promise.all([l(),n(),Re(document.getElementById("designer-container"),d),i()]);window.roomDesignerApi=h;const _=document.getElementById("ui-elements"),I=new Ve(h,_);window.emulator=I,h.ui.callbacks.onClickElement=f=>{console.log("clicked element",f)},console.log(h),h.plugins.dragIn.beforeUpdateGhost((f,H)=>{const S=E().getBoundingClientRect();return{x:f,y:H,options:{ghost:{visibleIn:{x:S.x,y:S.y,height:S.height,width:S.width}}}}}),window.addEventListener("message",f=>{f.origin==="http://localhost:3100"&&console.log(f.origin,f.data)}),He(h,I),ie(h,v),I.loadPosData(g),le(h,u),await et(h,I,a),h.ui.loadObject(e),document.getElementById("console-clear").onclick=()=>{let f=document.getElementById("console-log");for(;f.children.length>0;)f.removeChild(f.children[0])},document.getElementById("console-order-manager-group").onclick=async()=>{const f=await I.getOrderManagerGroupData("##roomlePlannerId##");x("GROUP-DATA:",JSON.stringify(f))},document.getElementById("download-glb").onclick=()=>{Je(h)},t&&m.waitForCatalog.then(()=>{const f=JSON.parse(JSON.stringify(v));ze(o,f,u)});const ce=performance.now()-tt;x(`Page loaded in ${ce} milliseconds`)};(async function(){await ot()})();export{he as _};
