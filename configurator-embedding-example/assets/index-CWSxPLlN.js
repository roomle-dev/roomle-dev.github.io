const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/drag-in-BEjBh6zz-CVB9qBuX.js","assets/drag-in-BEjBh6zz-Bj5iQsY1.js"])))=>i.map(i=>d[i]);
(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var e=`modulepreload`,t=function(e){return`/configurator-embedding-example/`+e},n={};const r=function(r,i,a){let o=Promise.resolve();if(i&&i.length>0){let r=document.getElementsByTagName(`link`),s=document.querySelector(`meta[property=csp-nonce]`),c=s?.nonce||s?.getAttribute(`nonce`);function l(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}o=l(i.map(i=>{if(i=t(i,a),i in n)return;n[i]=!0;let o=i.endsWith(`.css`),s=o?`[rel="stylesheet"]`:``;if(a)for(let e=r.length-1;e>=0;e--){let t=r[e];if(t.href===i&&(!o||t.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${i}"]${s}`))return;let l=document.createElement(`link`);if(l.rel=o?`stylesheet`:e,o||(l.as=`script`),l.crossOrigin=``,l.href=i,c&&l.setAttribute(`nonce`,c),document.head.appendChild(l),o)return new Promise((e,t)=>{l.addEventListener(`load`,e),l.addEventListener(`error`,()=>t(Error(`Unable to preload CSS for ${i}`)))})}))}function s(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then(e=>{for(let t of e||[])t.status===`rejected`&&s(t.reason);return r().catch(s)})};var i=class{_side;_incomingMessageBus=null;_outgoingMessageBus=null;_execMessage=null;constructor(e,t,n,r){this._side=e,this._incomingMessageBus=t,this._outgoingMessageBus=n,this._execMessage=r,this._incomingMessageBus&&this._incomingMessageBus.addEventListener(`message`,this._handleMessage.bind(this))}setOutgoingMessageBus(e){this._outgoingMessageBus=e}setMessageExecution(e){this._execMessage=e}sendMessage(e,t=[]){return new Promise((n,r)=>{if(this._incomingMessageBus===this._outgoingMessageBus)return n(void 0);let i=new MessageChannel;i.port1.onmessage=e=>{if(!e||!e.data)return i.port1.close(),i.port2.close(),r(Error(this._side+` received message but response can not be interpreted`));let t;try{t=JSON.parse(e.data)}catch(e){return i.port1.close(),i.port2.close(),this._prepareError(e),r(e)}t.error?r(t.error):t.result===void 0?n(void 0):n(t.result),i.port1.close(),i.port2.close()};let a=``;try{a=JSON.stringify({message:e,args:t})}catch{return r(Error(this._side+`: can not create command because it is not JSON.stringify able`))}if(!this._outgoingMessageBus)return r(Error(this._side+`: outgoing bus not set yet`));this._outgoingMessageBus.postMessage(a,`*`,[i.port2])})}_handleMessage(e){let t=e.ports&&Array.isArray(e.ports)&&e.ports.length>0?e.ports[0]:null;if(e.data&&(typeof e.data==`string`||e.data.type!==`connect_hi`)&&t)try{let n=JSON.parse(e.data);if(!this._execMessage)return t.postMessage(JSON.stringify({error:this._side+` is not ready to handle messages`}));Array.isArray(n.args)||(n.args=[n.args]);let r=this._execMessage(n,e);if(r===void 0)return;r.then((e={})=>{let n,r;typeof e==`object`&&e&&(n=e.error,r=e.result),n?t.postMessage(JSON.stringify({error:n})):r===void 0?t.postMessage(JSON.stringify({result:e})):t.postMessage(JSON.stringify({result:r}))},e=>{t.postMessage(JSON.stringify({error:this._prepareError(e)}))})}catch(e){t.postMessage(JSON.stringify({error:this._prepareError(e)}))}}_prepareError(e){if(typeof e==`string`){let t=this._side+`: `+e;return console.error(t),t}return e.message=this._side+`: `+e.message,console.error(e),e.message}},a=Symbol(`Comlink.proxy`),o=Symbol(`Comlink.endpoint`),s=Symbol(`Comlink.releaseProxy`),c=Symbol(`Comlink.finalizer`),l=Symbol(`Comlink.thrown`),u=e=>typeof e==`object`&&!!e||typeof e==`function`,d=new Map([[`proxy`,{canHandle:e=>u(e)&&e[a],serialize(e){let{port1:t,port2:n}=new MessageChannel;return p(e,t),[n,[n]]},deserialize(e){return e.start(),g(e)}}],[`throw`,{canHandle:e=>u(e)&&l in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(Error(e.value.message),e.value):e.value}}]]);function f(e,t){for(let n of e)if(t===n||n===`*`||n instanceof RegExp&&n.test(t))return!0;return!1}function p(e,t=globalThis,n=[`*`]){t.addEventListener(`message`,function r(i){if(!i||!i.data)return;if(!f(n,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}let{id:a,type:o,path:s}=Object.assign({path:[]},i.data),u=(i.data.argumentList||[]).map(E),d;try{let t=s.slice(0,-1).reduce((e,t)=>e[t],e),n=s.reduce((e,t)=>e[t],e);switch(o){case`GET`:d=n;break;case`SET`:t[s.slice(-1)[0]]=E(i.data.value),d=!0;break;case`APPLY`:d=n.apply(t,u);break;case`CONSTRUCT`:d=re(new n(...u));break;case`ENDPOINT`:{let{port1:t,port2:n}=new MessageChannel;p(e,n),d=ne(t,[t])}break;case`RELEASE`:d=void 0;break;default:return}}catch(e){d={value:e,[l]:0}}Promise.resolve(d).catch(e=>({value:e,[l]:0})).then(n=>{let[i,s]=T(n);t.postMessage(Object.assign(Object.assign({},i),{id:a}),s),o===`RELEASE`&&(t.removeEventListener(`message`,r),h(t),c in e&&typeof e[c]==`function`&&e[c]())}).catch(e=>{let[n,r]=T({value:TypeError(`Unserializable return value`),[l]:0});t.postMessage(Object.assign(Object.assign({},n),{id:a}),r)})}),t.start&&t.start()}function m(e){return e.constructor.name===`MessagePort`}function h(e){m(e)&&e.close()}function g(e,t){let n=new Map;return e.addEventListener(`message`,function(e){let{data:t}=e;if(!t||!t.id)return;let r=n.get(t.id);if(r)try{r(t)}finally{n.delete(t.id)}}),x(e,n,[],t)}function _(e){if(e)throw Error(`Proxy has been released and is not useable`)}function v(e){return D(e,new Map,{type:`RELEASE`}).then(()=>{h(e)})}var y=new WeakMap,b=`FinalizationRegistry`in globalThis&&new FinalizationRegistry(e=>{let t=(y.get(e)||0)-1;y.set(e,t),t===0&&v(e)});function ee(e,t){let n=(y.get(t)||0)+1;y.set(t,n),b&&b.register(e,t,e)}function te(e){b&&b.unregister(e)}function x(e,t,n=[],r=function(){}){let i=!1,a=new Proxy(r,{get(r,o){if(_(i),o===s)return()=>{te(a),v(e),t.clear(),i=!0};if(o===`then`){if(n.length===0)return{then:()=>a};let r=D(e,t,{type:`GET`,path:n.map(e=>e.toString())}).then(E);return r.then.bind(r)}return x(e,t,[...n,o])},set(r,a,o){_(i);let[s,c]=T(o);return D(e,t,{type:`SET`,path:[...n,a].map(e=>e.toString()),value:s},c).then(E)},apply(r,a,s){_(i);let c=n[n.length-1];if(c===o)return D(e,t,{type:`ENDPOINT`}).then(E);if(c===`bind`)return x(e,t,n.slice(0,-1));let[l,u]=C(s);return D(e,t,{type:`APPLY`,path:n.map(e=>e.toString()),argumentList:l},u).then(E)},construct(r,a){_(i);let[o,s]=C(a);return D(e,t,{type:`CONSTRUCT`,path:n.map(e=>e.toString()),argumentList:o},s).then(E)}});return ee(a,e),a}function S(e){return Array.prototype.concat.apply([],e)}function C(e){let t=e.map(T);return[t.map(e=>e[0]),S(t.map(e=>e[1]))]}var w=new WeakMap;function ne(e,t){return w.set(e,t),e}function re(e){return Object.assign(e,{[a]:!0})}function T(e){for(let[t,n]of d)if(n.canHandle(e)){let[r,i]=n.serialize(e);return[{type:`HANDLER`,name:t,value:r},i]}return[{type:`RAW`,value:e},w.get(e)||[]]}function E(e){switch(e.type){case`HANDLER`:return d.get(e.name).deserialize(e.value);case`RAW`:return e.value}}function D(e,t,n,r){return new Promise(i=>{let a=ie();t.set(a,i),e.start&&e.start(),e.postMessage(Object.assign({id:a},n),r)})}function ie(){return[,,,,].fill(0).map(()=>Math.floor(Math.random()*(2**53-1)).toString(16)).join(`-`)}var O=`.`,k={REQUEST_BOOT:`requestBoot`,SETUP:`setup`,WEBSITE_READY:`websiteReady`},A={GET_METHODS:`getMethods`,RETURN_METHODS:`returnMethods`,REGISTER_CUSTOM_VIEW:`registerCustomView`,REGISTER_CUSTOM_VIEW_DONE:`registerCustomViewDone`},ae=async(e,t)=>{if(typeof e!=`string`)throw Error(`Configurator ID is not a string type: "`+typeof e+`"`);let n=t.customApiUrl?t.customApiUrl:`https://api.roomle.com/v2`,r=t.overrideTenant||9,i=n+`/configurators/`+e,a=`03-`+window.btoa(new Date().toISOString()+`;anonymous;roomle_portal_v2`),o=new Request(i,{method:`GET`,headers:(()=>{let e={apiKey:`roomle_portal_v2`,currentTenant:r,locale:`en`,language:`en`,device:1,token:a,platform:`web`};return new Headers(e)})(),mode:`cors`,cache:`default`}),{configurator:s}=await(await fetch(o)).json();return s},oe=()=>{try{return window.self!==window.top}catch{return!0}},se=[`127.0.0.1`,`localhost`,`0.0.0.0`],ce=()=>{let e=oe(),t=window.location.href;if(e){if(!document.referrer)return null;t=document.referrer}let{hostname:n}=new URL(t);return n},le=e=>!!(se.includes(e)||e.endsWith(`roomle.com`)||e.endsWith(`gitlab.io`)||e.endsWith(`gitlab.com`)),j=[`language`,`browserLanguage`,`userLanguage`,`systemLanguage`],M=(e=null)=>{let t=window.navigator;if(e)return e.substr(0,2);if(Array.isArray(t.languages)&&t.languages.length>0)return t.languages[0].substr(0,2);for(let e=0,n=j.length;e<n;e++){let n=t[j[e]];if(n)return n.substr(0,2)}return`en`},N=(e,t)=>P(JSON.parse(JSON.stringify(e)),t),P=(e,t)=>{for(let n in t)try{t[n].constructor===Object?e[n]=P(e[n],t[n]):e[n]=t[n]}catch{e[n]=t[n]}return e},F=(e=>(e.BOTTOM_BAR=`bottom_bar`,e.PARTLIST_BOUNDS=`partlist_bounds`,e.INTERACTION_NOTES=`interaction_notes`,e.PARAMETER_GROUPS=`parameter_groups`,e))(F||{}),I=e=>JSON.parse(JSON.stringify(e)),L={mobileLandscape:!0,floorMaterialRootTag:`materials_root`,buttons:{renderimage:!0,requestproduct:!0,requestplan:!0,load_product:!0,partlist_print:!0},elements:{[F.INTERACTION_NOTES]:!0},helpcenter:{roomdesigner:!0,configurator:!1,disable:!1},firstPersonView:!0,saveToIdb:!0,featureFlags:{mocAr:!0,wallAutoHeight:!1,openCloseAnimation:!0,enableTwoLevelCatalog:!1},rotationSnapDegrees:10,interactionsCollapsed:!1},R=`(idle)`,z=e=>(B(e),e?.customApiUrl&&(e.customApiUrl=decodeURIComponent(e.customApiUrl)),e.shareUrl&&(e.deeplink=e.shareUrl.replace(U,ue)),e),B=e=>{if(!e)return;let t=Object.keys(e);for(let n of t){let t=e[n];if(!Array.isArray(t)&&typeof t==`object`&&t&&B(t),Array.isArray(t))for(let e of t)B(e);(t===`true`||t===`false`)&&(e[n]=t===`true`)}},V=(e,t)=>{t.configuratorId=e.id;let n=e.settings||{};return!t.overrideTenant&&e.tenant&&(t.overrideTenant=e.tenant),N(n,t)},H=()=>{let e=I(L);e.locale||=M(),e.id===R&&delete e.id;let t=ce();return t&&le(t)&&(e.configuratorId=`demoConfigurator`),e.customApiUrl=void 0,e.emails=!1,e},U=`<CONF_ID>`,ue=`#CONFIGURATIONID#`,de=e=>{e.featureFlags||={},typeof e.featureFlags.realPartList!=`boolean`&&(e.featureFlags.realPartList=!0),typeof e.featureFlags.globalCallbacks!=`boolean`&&(e.featureFlags.globalCallbacks=!0),typeof e.featureFlags.mocAr!=`boolean`&&(e.featureFlags.mocAr=!1)},W=()=>/(android)/i.test(navigator.userAgent),G=class{_messageHandler=null;isSetupDone=!1;viewName=`main`;plugins={};pluginsLoaded=[];ui={callbacks:null};extended={callbacks:null};configurator={callbacks:null};analytics={callbacks:{}};rapi={callbacks:{}};global={callbacks:{}};setMessageHandler(e){this._messageHandler=e}handleSetup(e){let{methods:t,callbacks:n}=e;t.forEach(e=>{let t=e.split(O),n=t[0],r=t[1];this[n]||(this[n]={}),this[n][r]=(function(){if(!this._messageHandler){console.error(`MessageHandler not set`);return}return this._messageHandler.sendMessage(e,[...arguments])}).bind(this)}),n.forEach(e=>{let t=e.split(O),n=t[0],r=t[1],i=t[2];this[n]||(this[n]={}),this[n][r]||(this[n][r]={}),this[n][r][i]=()=>{}}),this.isSetupDone=!0}executeMessage({message:e,args:t}){let n=e.split(O),r=n[0],i=n[1],a=n.length===3?n[2]:null;if(a&&this[r][i][a]){let e=this[r][i][a](...t);return e instanceof Promise?e.then(e=>({result:e})):e===void 0?Promise.resolve({result:null}):Promise.resolve({result:e})}return Promise.reject(`Message "`+e+`" is unkown`)}setupPlugins(e,t,n=`website`){for(let i of e)typeof i==`string`&&i===`dragIn`?this.pluginsLoaded.push(new Promise((e,i)=>{try{r(()=>import(`./drag-in-BEjBh6zz-CVB9qBuX.js`),__vite__mapDeps([0,1])).then(e=>e.l).then(({DragIn:r})=>{let a=new r(this.ui,t,n,this.viewName);a.init().then(()=>{this.plugins.dragIn=a,e()},i)})}catch(e){i(e)}})):i.name&&i.loader&&this.pluginsLoaded.push(new Promise((e,r)=>{try{i.loader().then(a=>{let o=new a(this.ui,t,n,this.viewName);o.init().then(()=>{this.plugins[i.name]=o,e()},r)})}catch(e){r(e)}}))}},K=()=>{let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}},q=(e,t,n)=>{let r=null;Object.defineProperty(e,t,{get(){return r||n},set(e){e?.mute?r=e.value:(console.warn(`You override Roomle defined behaviour. To disalbe this warning pass in an object with the following properties`),console.warn(`{ mute: true, value: () => void }`),r=e)}})},J=()=>window.innerHeight*.01+`px`,Y=e=>{e&&setTimeout(()=>e.style.setProperty(Z,J()),0)},X=`rml-styles`,fe=450,Z=`--rml-full-height`,Q={CONTAINER:`rml-container`,FILL:`rml-fill`,POSITION:`rml-pos`,TRANSITION:`rml-transition`,ANDROID_HEIGHT:`rml-android-height`,OVERFLOW_HIDDEN:`rml-overflow-hidden`},$=new Map,pe=e=>new Proxy(e,{get(e,t,n){let r=Reflect.get(e,t,n);return r===void 0?(console.warn(`[Homag Intelligence Callbacks] Method '${String(t)}' is not implemented. Executing a no-op.`),(...e)=>{}):r}}),me=class extends G{static createPlanner(e,t,n,r=[]){return this._create(e,t,n,r)}static async connect(e,t=[]){let n=new G;n.viewName=e;let{resolve:r,promise:a}=K(),{resolve:o,promise:s}=K(),c=new i(`custom-view-`+e,window,window.parent,({message:e,args:t})=>{switch(e){case A.REGISTER_CUSTOM_VIEW_DONE:r();break;case A.RETURN_METHODS:n.handleSetup(t[0]),o();break;default:if(n.isSetupDone)return n.executeMessage({message:e,args:t})}});n.setMessageHandler(c);let l=[e];return c.sendMessage(A.REGISTER_CUSTOM_VIEW,l),await a,c.sendMessage(A.GET_METHODS,l),await s,n.setupPlugins(t,document.body,`custom-view`),await Promise.allSettled(n.pluginsLoaded),n}static createConfigurator(e,t,n,r=[]){return this._create(e,t,n,r)}static create(e,t,n,r){return this._create(e,t,n,r)}static createViewer(e,t,n,r=[]){return this._create(e,t,n,r)}static setupHi(e){window.addEventListener(`message`,t=>{if(t.data.type===`connect_hi`&&t.data.port){let n=t.data.port;n.start?.(),p(pe(e),n)}})}static async _create(e,t,n,r){return new Promise(async(i,a)=>{try{let a=P(H(),z(n));de(a);let o=await ae(e,a);n=V(o,a);let s=new this(o,t,n,r,i);return await Promise.allSettled(s.pluginsLoaded),s}catch(e){return a(e)}})}_waitForIframe;_container;_configuratorSettings;_initData={};_iframe;constructor(e,t,n,r,a){if(super(),!e||typeof e.id!=`string`)throw Error(`Please provide a correct configuratorId, you get the correct ID from your Roomle Contact Person`);if($.has(t))throw Error(`There is already an instance on this DOM element`);if(!document.getElementById(X)){let e=n.zIndex||9999999,t=document.createElement(`style`);t.type=`text/css`,t.id=X;let r=`transition:all ease-in-out `+fe+`ms;`,i=[`-webkit-`,`-o-`].reduce((e,t)=>e+=t+r,``)+r,a=J();t.innerHTML=`
        .${Q.CONTAINER}{${Z}:${a};}
        .${Q.POSITION}{position:fixed;top:0;left:0;z-index:${e};opacity:0}
        .${Q.TRANSITION}{${i}}
        .${Q.FILL}{width:100%;height:100%;opacity:1}
        .${Q.ANDROID_HEIGHT}{height:calc(var(${Z},1vh)*100)}
        .${Q.OVERFLOW_HIDDEN}{overflow:hidden}
      `,document.head.appendChild(t)}this._executeMessage=this._executeMessage.bind(this);let o=new i(`website`,window,null,this._executeMessage);this.setMessageHandler(o),this._onResize=this._onResize.bind(this),W()&&window.addEventListener(`resize`,this._onResize),this._container=t,this._initData=n,this._configuratorSettings=e;let s=this._createIframe();this._onUseFullPage=this._onUseFullPage.bind(this),this._onBackToWebsite=this._onBackToWebsite.bind(this),this._waitForIframe=a,this._container.appendChild(s),this._iframe=s,this.setupPlugins(r,this._iframe),$.set(t,!0)}teardown(){this._container&&$.delete(this._container);let e=this._container.querySelector(`iframe`);e&&this._container.removeChild(e),window.removeEventListener(`resize`,this._onResize)}_createIframe(){let e=document.createElement(`iframe`),t=this._configuratorSettings?.url||`https://www.roomle.com/t/cp/`;return this._initData.useLocalRoomle&&(t=location.href.replace(`embedding.html`,``)),location.href.includes(`roomle.gitlab.io`)&&(t=location.href.replace(`embedding.html`,`index.html`)),this._initData.overrideServerUrl&&(t=this._initData.overrideServerUrl),e.src=t,e.classList.add(Q.CONTAINER),e.classList.add(Q.FILL),e}_onResize(){Y(this._iframe)}_onUseFullPage(){this._iframe.classList.add(Q.POSITION),document.documentElement.classList.add(Q.OVERFLOW_HIDDEN),window.document.body.classList.add(Q.OVERFLOW_HIDDEN),W()&&(Y(this._iframe),this._iframe.classList.add(Q.ANDROID_HEIGHT))}_onBackToWebsite(){this._iframe.classList.remove(Q.POSITION),this._iframe.classList.remove(Q.ANDROID_HEIGHT),document.documentElement.classList.remove(Q.OVERFLOW_HIDDEN),window.document.body.classList.remove(Q.OVERFLOW_HIDDEN)}_executeMessage({message:e,args:t},n){if(n.source&&n.source===this._iframe?.contentWindow)return e===k.REQUEST_BOOT?this._messageHandler?(this._messageHandler.setOutgoingMessageBus(n.source),Promise.resolve({result:this._initData})):(console.error(`MessageHandler not set`),Promise.resolve({error:`MessageHandler not set`})):e===k.SETUP?(this.handleSetup(t[0]),q(this.ui.callbacks,`onUseFullPage`,this._onUseFullPage),q(this.ui.callbacks,`onBackToWebsite`,this._onBackToWebsite),this._waitForIframe(this),setTimeout(()=>{if(!this._messageHandler){console.error(`MessageHandler not set`);return}this._messageHandler.sendMessage(k.WEBSITE_READY)},0),Promise.resolve({result:null})):this.executeMessage({message:e,args:t})}};(async()=>{let e=document.getElementById(`app`);await(await me.createConfigurator(`demoConfigurator`,e,{},[])).ui.loadObject(`usm:frame`)})();export{r as t};